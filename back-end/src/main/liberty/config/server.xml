<?xml version="1.0" encoding="UTF-8"?>
<server description="new server">

    <!-- Enable features -->
    <featureManager>
        <feature>webProfile-10.0</feature>
        <feature>microProfile-7.0</feature>
    </featureManager>

    <!-- This template enables security. To get the full use of all the capabilities, a keystore and user registry are required. -->

    <!-- For the keystore, default keys are generated and stored in a keystore. To provide the keystore password, generate an 
        encoded password using bin/securityUtility encode and add it below in the password attribute of the keyStore element. 
        Then uncomment the keyStore element. -->
    <!--
    <keyStore password=""/> 
    -->

    <!-- Basic Registry required for Jakarta EE 10.0 -->
    <basicRegistry id="basic" realm="BasicRealm">
        <user name="admin" password="admin123" />
    </basicRegistry>

    <!-- To access this server from a remote client add a host attribute to the following element, e.g. host="*" -->
    <httpEndpoint id="defaultHttpEndpoint"
                  httpPort="${env.APP_HTTP_PORT}"
                  httpsPort="${env.APP_HTTPS_PORT}" />

    <!-- Automatically expand WAR files and EAR files -->
    <applicationManager autoExpand="true"/>

    <!-- Configures the application on a specified context root -->
    <webApplication contextRoot="/kudo-app" location="kudo-application.war" />

    <!-- Default SSL configuration enables trust for default certificates from the Java runtime -->
    <ssl id="defaultSSLConfig" trustDefaultCerts="true" />
    
    <!-- PostgreSQL JDBC Library -->
    <library id="postgresqlLib">
        <fileset dir="${server.config.dir}/lib" includes="postgresql-*.jar"/>
    </library>
    
    <!-- Default PostgreSQL DataSource  -->
    <dataSource id="DefaultDataSource" jndiName="jdbc/kudosdb">
        <jdbcDriver libraryRef="postgresqlLib"/>
        <properties.postgresql 
            serverName="${env.DB_HOST}"
            portNumber="${env.DB_PORT}"
            databaseName="${env.DB_NAME}"
            user="${env.DB_USER}"
            password="${env.DB_PASSWORD}"
            ssl="false"
            applicationName="KudosCardSystem"/>
        <connectionManager maxPoolSize="20" minPoolSize="5" connectionTimeout="30s"/>
    </dataSource>
    
</server>
